{% extends 'qa/base.html' %}
{% block title %}{{ question.title }}{% endblock %}
{% block content %}
<h2>{{ question.title }}</h2>
<p class="text-muted">Asked by {{ question.author }} on {{ question.created_at|date:"M d, Y H:i" }} â€¢ {{ question.views }} views</p>
<p>{{ question.body }}</p>
{% if question.approved and user.is_authenticated and user != question.author %}
    <a href="{% url 'flag-create' 'question' question.pk %}" class="btn btn-warning btn-sm">Flag Question</a>
{% endif %}

{% if user == question.author %}
    <a href="{% url 'question-update' question.pk %}" class="btn btn-sm btn-outline-primary">Edit</a>
    <a href="{% url 'question-delete' question.pk %}" class="btn btn-sm btn-outline-danger">Delete</a>
    
{% endif %}

<hr>
{% for answer in answers %}
    <div class="card mb-3">
        <div class="card-body">
            <p>{{ answer.body }}</p>
            <small class="text-muted">By {{ answer.author }} on {{ answer.created_at|date:"M d, Y H:i" }}</small>
  
            {% if answer.approved and user.is_authenticated and user != answer.author %}
                <a href="{% url 'flag-create' 'answer' answer.pk %}" class="btn btn-warning btn-sm">Flag Answer</a>
            {% endif %}

            {% if user == answer.author %}
                <div class="mt-2">
                    <a href="{% url 'answer-update' answer.pk %}" class="btn btn-sm btn-outline-primary">Edit</a>
                    <a href="{% url 'answer-delete' answer.pk %}" class="btn btn-sm btn-outline-danger">Delete</a>
                    
                    {% if not answer.approved %}
                        <span class="badge bg-warning text-dark">Pending Approval</span>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>
{% empty %}
    <p>No answers yet.</p>
{% endfor %}


{% if user.is_authenticated %}
    <hr>
    <a href="{% url 'answer-create' question.pk %}" class="btn btn-outline-success">Add Answer</a>
{% else %}
    <p><a href="{% url 'login' %}">Login</a> to post an answer.</p>
{% endif %}
{% endblock %}
